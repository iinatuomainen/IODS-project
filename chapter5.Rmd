---
title: "chapter5.Rmd"
output: html_document
---
#Data includes 195 observations and 19 variables. There is two characters variables, four intervals and the others are numeric.
```{r}
read.csv(file = "~/IODS-project/data/human")
str(human)
dim(human)
```

#Mutate the Gross National Income (GrossNat) variable into numeric:
```{r}
library(stringr)
library(dplyr)
str(human$GNI)
human <- mutate(human, GNI = str_replace(human$GNI, pattern=",", replace ="") %>% as.numeric)
str(human$GNI)
str(human)
```

#Exclude unneeded variables 
```{r}
names(human)
keep <- c("Country", "edu2.FM", "lab.FM", "Life.exp", "Years.exp", "GNI", "mater.mor", "adol.birth", "rep.parl")
human <- select(human, one_of(keep))
names(human)
```

#Remove all rows with missing values
```{r}
complete.cases(human)
data.frame(human [-1], comp=complete.cases(human))
human_ <- filter(human, complete.cases(human))
dim(human_)
complete.cases(human_)
```

#Remove the observations which relate to regions instead of countries
```{r}
dim(human)
dim(human_)
tail(human_, n=10)
last <- nrow(human_) - 7
human_ <- human_[1:last,]
dim(human_)
```

#Define the row names of the data and remove the country name column from the data.
```{r}
rownames(human_) <- human_$Country
human_ <- select(human_, -Country)
dim(human_)
str(human_)
write.csv(human_, file = "~/IODS-project/data/human_")
```

#Graphical overview and summaries of the variables
```{r}
library(GGally); library(ggplot2)
ggpairs(human_)
cor(human_)%>%corrplot()
```
#The most strongest correlation is between mater mortality ratio and life expectancy at birth, and the correlation is negative.

#Analysis of PCA without standardized data 
```{r}
pca_human <- prcomp(human_)
biplot(pca_human, choices = 1:2, cex = c(0.8,1), col = c("grey40", "deeppink2"))
```

#Standardize the variables in the human data and same analysis as above
```{r}
human_std <- scale(human_)
pca_human2 <- prcomp(human_std)
biplot(pca_human2, choices = 1:2, cex = c(0.8,1), col = c("grey40", "deeppink2"))
```



```{r}
library(ggplot2); library(FactoMineR); library(dplyr); library(tidyr)
data(tea)
str(tea)
dim(tea)
keep_columns <- c("Tea", "How", "how", "sugar", "where", "lunch")
tea_time <- select(tea, one_of(keep_columns))
summary(tea_time)
str(tea_time)
```


#Visualizing the dataset and multiple correspondence analysis
```{r}
gather(tea_time) %>% ggplot(aes(value)) + facet_wrap("key", scales = "free") + geom_bar() + theme(axis.text.x = element_text(angle = 45, hjust = 1, size = 8))
maca <- MCA(tea_time, graph = FALSE)
plot(maca, invisible=c("ind"), habillage = "quali")
```